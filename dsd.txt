WHEN asv.visit_oid::text = 'C1D1'::text THEN rand.visit_date_actl
            ELSE date(lsv.actual_visit_date + (acl.cycle_length * (asv."cycle" - lsv."cycle") + asv."day" - lsv."day" - asv.visit_window)::double precision * '1 day'::interval)
        END::text || ' to '::text) || 
        CASE
            WHEN asv.visit_oid::text = 'C1D1'::text THEN date(rand.visit_date_actl + 7::double precision * '1 day'::interval)
            ELSE date(lsv.actual_visit_date + (acl.cycle_length * (asv."cycle" - lsv."cycle") + asv."day" - lsv."day" + asv.visit_window)::double precision * '1 day'::interval)
        END::text AS expected_visit_window, 
        CASE
            WHEN asv.actual_visit_date IS NOT NULL THEN 'Y'::text
            ELSE 'N'::text
        END AS data_status_edc_rave, 
        CASE
            WHEN asv.specimen_id IS NOT NULL THEN 'Y'::text
            ELSE 'N'::text
        END AS data_status_labcorp, 
        CASE
            WHEN lsv.actual_visit_date < 
            CASE
                WHEN asv.visit_oid::text = 'C1D1'::text THEN rand.visit_date_actl
                ELSE date(lsv.actual_visit_date + (acl.cycle_length * (asv."cycle" - lsv."cycle") + asv."day" - lsv."day" - asv.visit_window)::double precision * '1 day'::interval)
            END AND 
            CASE
                WHEN asv.visit_oid::text = 'C1D1'::text THEN date(rand.visit_date_actl + 7::double precision * '1 day'::interval)
                ELSE date(lsv.actual_visit_date + (acl.cycle_length * (asv."cycle" - lsv."cycle") + asv."day" - lsv."day" + asv.visit_window)::double precision * '1 day'::interval)
